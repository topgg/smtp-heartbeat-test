# smtp-heartbeat-test

## 邮件心跳监测

生产环境中，我们常常遇到以下问题

向SMTP 服务器发送指令后，SMTP 服务器既没有返回失败，也没有成功发送邮件。

解决思路：

有三个思路

1. 早期自动重启避免问题出现
2. 诊断出具体原因,难点在于大家并没有太多精力研究邮件使用的开源组件，具体的故障难以排查，即使查出了根本问题也没有能力修复
3. 使用本心跳监测程序，及时发现问题，切换SMTP 服务器，业务上应该及时发现问题，尽早切换SMTP服务器，心跳监测程序会将可用性发布在后台。其他程序可通过标准APiece接口获取此聊表状态，相当于一个集中的资源可用性发布中心。数据库。
4. 同样此项目可以扩展到其他资源的可用性维护上


讨论方法4 的使用原理

1. 资源可用性发布中心，对于smtp类数据的采集必须通过调用 25发送邮件，确认邮件送达，资源可用中心显示正常。
2. 现有的smtp 代码中必须将可用smtp地址，使用api方式获取，实现动态的可用性变更。类似于etcd 
3. 

技术栈：

Python
web框架使用 django booststarp
API  flasks
No-SQL
可用度信息只需要维护24小时以内的
并用图形化页面展示



